---
title: "Redis캐시로 성능향상하기(작성중)"
layout: post
---

AWS 레디스 서버에서 요청들이 줄서서 대기하는 현상이 발생했다. 업무로직에서 특정 캐시네임에 대해 @cacheEvict 시 allEntries=true로 파라미터를 준 때문에 발생한 현상이었다.


{% highlight python %}
KEYS pattern
{% endhighlight %}

<link href="https://redis.io/commands/keys/" rel="stylesheet">

공식문서에 KEYS 기능에 대해 Returns all keys matching pattern. 이라고 명시되어있는데, evict 대상을 찾을때 KEYS 뒤에 * 파라미터(allEntries=true)가 오며 해당 캐시네임과 동일한 모든 키를 탐색하며 부하가 걸린 것.

해결방법으로 @Caching쪽과 @CacheEvict하는 쪽 모두 동일한 구체적인 키값을 주는 것으로 방향을 정했으나, 알고보니 양쪽의 메소드 파라미터의 오브젝트 자체가 서로 달라 수정해야할 범위가 꽤 많았음. 거기다 evict할때 두 개의 캐시키를 동시에 해주는 부분이고, 두 개의 캐시키 모두 서로 다른 파라미터를 물고 있었다. (왜 코드작성자가 냅다 allEntries=true로 evict시켜버렸는지 알 것 같았음)

{% highlight java %}
@Cacheable
{% endhighlight %}



<font color='#909194'>Last updated: March 29, 2024</font>